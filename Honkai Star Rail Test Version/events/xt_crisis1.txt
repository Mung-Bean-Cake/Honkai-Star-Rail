namespace = DDT_FY
###### 天灾启动
#country_event DDT_FY.10
###### 事件链开始
#提醒事件
country_event = {
    id = DDT_FY.1
    title = DDT_FY.1_name
    desc = DDT_FY.1_desc
    picture = GFX_evt_glitchy_matrix
    is_triggered_only = yes

    option = {
        name = OK
        owner = {
            begin_event_chain = {
                event_chain = "antimatter_legion_chain"
                target = this
            }
        }
    }
}
country_event = {
    id = DDT_FY.2
    title = DDT_FY.2_name
    desc = DDT_FY.2_desc
    picture = GFX_evt_glitchy_matrix
    is_triggered_only = yes

    option = {
        name = DDT_FY.2_name_one
        add_resource = {
            influence = 100
            unity = -3000
        }
        owner = {
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
        }
    }
    option = {
        name = DDT_FY.2_name_two
        add_modifier = { modifier = Unknown_risk1  days = 600 }
        owner = {
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
        }
    }
}
country_event = {
    id = DDT_FY.3
    title = DDT_FY.3_name
    desc = DDT_FY.3_desc
    picture = GFX_evt_crisis_2
    is_triggered_only = yes

    option = {
        name = DDT_FY.3_name_one
        owner = {
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
        }
    }
}
country_event = {
    id = DDT_FY.4
    title = DDT_FY.4_name
    desc = DDT_FY.4_desc
    picture = GFX_evt_crisis_2
    is_triggered_only = yes

    trigger = {
        is_ai = no
    }

    option = {
        name = DDT_FY.4_name_one
        hidden_effect = {
            country_event = { id = DDT_FY.11 days = 10 }
            country_event = { id = DDT_FY.13 days = 20 }
            country_event = { id = DDT_FY.14 days = 30 }
            country_event = { id = DDT_FY.15 days = 40 }
            country_event = { id = DDT_FY.16 days = 50 }
            country_event = { id = DDT_FY.17 days = 60 }
            country_event = { id = DDT_FY.18 days = 70 }
        }
        owner = {
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
        }
    }
}
country_event = {
    id = DDT_FY.5
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            country_event = { id = DDT_FY.12 }
        }
    }
}
observer_event = {
    id = DDT_FY.6
    title = DDT_FY.6_name
    desc = DDT_FY.6_desc
    picture = GFX_evt_crisis_4
    is_triggered_only = yes

    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.7
    title = DDT_FY.6_name
    desc = DDT_FY.6_desc
    picture = GFX_evt_crisis_4
    is_triggered_only = yes

    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.8
    title = DDT_FY.8_name
    desc = DDT_FY.8_desc
    diplomatic = yes

    picture_event_data = {
        portrait = huimie
        room = didui_0_room
    }

    is_triggered_only = yes

    option = {
        name = DDT_FY.8_name_one
    }
}
##############   准备开始，提醒
country_event = {
    id = DDT_FY.10
    is_triggered_only = yes
    hide_window = yes
    fire_only_once = yes

    trigger = {
        is_ai = no
        is_antimatter_must = yes
    }

    immediate = {
        set_global_flag = xt_antimatter_legion
        remove_country_flag = allow_set_xt_crisis_global
        every_country = {
            limit = { is_antimatter_must = yes }
            country_event = { id = DDT_FY.1 }
        }
        every_country = {
            limit = { is_antimatter_must = yes }
            country_event = { id = DDT_FY.2 days = 300 random = 50 }
        }
        every_country = {
            limit = { is_antimatter_must = yes }
            country_event = { id = DDT_FY.3 days = 600 random = 50 }
        }
        every_country = {
            limit = { is_antimatter_must = yes }
            country_event = { id = DDT_FY.4 days = 900 random = 100 }
        }
    }
}
#选择目标星系
country_event = {
    id = DDT_FY.11
    is_triggered_only = yes
    hide_window = yes
    fire_only_once = yes

    immediate = {
        random_system = {
            limit = {
                has_planet_class = pc_gaia
            }
            set_star_flag = first_star_order
            set_spawn_system_batch = begin
            spawn_system = {
                min_distance = 10
                max_distance = 12
                initializer = antimatter_legion_Sub_galaxies
                effect = {
                    set_name = "NAME_FENFENG"
                    save_global_event_target_as = antimatter_legion_Sub_galaxies1
                    random_system_planet = {
                        limit = {
                            has_planet_flag = born_antimatter_legion
                        }
                        planet_event = { id = DDT_FY.21  days = 10 }
                    }
                }
            }
            set_spawn_system_batch = end
            add_hyperlane = {
                from = event_target:antimatter_legion_Sub_galaxies1
                to = This
            }
        }
    }
}
country_event = {
    id = DDT_FY.13
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_system = {
            limit = {
            }
            set_star_flag = second_star_order
            set_spawn_system_batch = begin
            spawn_system = {
                min_distance = 10
                max_distance = 12
                initializer = antimatter_legion_Sub_galaxies
                effect = {
                    set_name = "NAME_XINGXIAO"
                    save_global_event_target_as = antimatter_legion_Sub_galaxies2
                    random_system_planet = {
                        limit = {
                            has_planet_flag = born_antimatter_legion
                        }
                        planet_event = { id = DDT_FY.22 days = 20 }
                    }
                }
            }
            set_spawn_system_batch = end
            add_hyperlane = {
                from = event_target:antimatter_legion_Sub_galaxies2
                to = This
            }
        }
    }
}
country_event = {
    id = DDT_FY.14
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_system = {
            if = {
                limit = {
                    is_capital_system = yes
                    #exists = starbase
                    #is_owned_by = Root
                    Root = {
                        owner_main_species = {
                            OR = {
                                is_archetype = ROBOT
                                is_archetype = MACHINE
                            }
                        }
                    }
                }
                set_star_flag = third_star_order
                set_spawn_system_batch = begin
                spawn_system = {
                    min_distance = 10
                    max_distance = 12
                    initializer = antimatter_legion_Sub_galaxies
                    effect = {
                        set_name = "NAME_TIEMU"
                        save_global_event_target_as = antimatter_legion_Sub_galaxies3
                        random_system_planet = {
                            limit = {
                                has_planet_flag = born_antimatter_legion
                            }
                            planet_event = { id = DDT_FY.23 days = 30 }
                        }
                    }
                }
                set_spawn_system_batch = end
                add_hyperlane = {
                    from = event_target:antimatter_legion_Sub_galaxies3
                    to = This
                }
            }
            else = {
                set_star_flag = third_star_order
                set_spawn_system_batch = begin
                spawn_system = {
                    min_distance = 10
                    max_distance = 12
                    initializer = antimatter_legion_Sub_galaxies
                    effect = {
                        set_name = "NAME_TIEMU"
                        save_global_event_target_as = antimatter_legion_Sub_galaxies3
                        random_system_planet = {
                            limit = {
                                has_planet_flag = born_antimatter_legion
                            }
                            planet_event = { id = DDT_FY.23 days = 30 }
                        }
                    }
                }
                set_spawn_system_batch = end
                add_hyperlane = {
                    from = event_target:antimatter_legion_Sub_galaxies3
                    to = This
                }
            }
        }
    }
}
country_event = {
    id = DDT_FY.15
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_system = {
            if = {
                limit = {
                    is_capital_system = yes
                    #exists = starbase
                    #is_owned_by = Root
                    Root = {
                        has_ethic = ethic_fanatic_spiritualist
                    }
                }
                set_star_flag = fourth_star_order
                set_spawn_system_batch = begin
                spawn_system = {
                    min_distance = 10
                    max_distance = 12
                    initializer = antimatter_legion_Sub_galaxies
                    effect = {
                        set_name = "NAME_DUSHEN"
                        save_global_event_target_as = antimatter_legion_Sub_galaxies4
                        random_system_planet = {
                            limit = {
                                has_planet_flag = born_antimatter_legion
                            }
                            planet_event = { id = DDT_FY.24 days = 40 }
                        }
                    }
                }
                set_spawn_system_batch = end
                add_hyperlane = {
                    from = event_target:antimatter_legion_Sub_galaxies4
                    to = This
                }
            }
            else_if = {
                limit = {
                    is_capital_system = yes
                    #exists = starbase
                    #is_owned_by = Root
                    Root = {
                        has_ethic = ethic_spiritualist
                    }
                }
                set_star_flag = fourth_star_order
                set_spawn_system_batch = begin
                spawn_system = {
                    min_distance = 10
                    max_distance = 12
                    initializer = antimatter_legion_Sub_galaxies
                    effect = {
                        set_name = "NAME_DUSHEN"
                        save_global_event_target_as = antimatter_legion_Sub_galaxies4
                        random_system_planet = {
                            limit = {
                                has_planet_flag = born_antimatter_legion
                            }
                            planet_event = { id = DDT_FY.24 days = 40 }
                        }
                    }
                }
                set_spawn_system_batch = end
                add_hyperlane = {
                    from = event_target:antimatter_legion_Sub_galaxies4
                    to = This
                }
            }
            else = {
                set_star_flag = fourth_star_order
                set_spawn_system_batch = begin
                spawn_system = {
                    min_distance = 10
                    max_distance = 12
                    initializer = antimatter_legion_Sub_galaxies
                    effect = {
                        set_name = "NAME_DUSHEN"
                        save_global_event_target_as = antimatter_legion_Sub_galaxies4
                        random_system_planet = {
                            limit = {
                                has_planet_flag = born_antimatter_legion
                            }
                            planet_event = { id = DDT_FY.24 days = 40 }
                        }
                    }
                }
                set_spawn_system_batch = end
                add_hyperlane = {
                    from = event_target:antimatter_legion_Sub_galaxies4
                    to = This
                }
            }
        }
    }
}
country_event = {
    id = DDT_FY.16
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_system = {
            limit = {
            }
            set_star_flag = fifth_star_order
            set_spawn_system_batch = begin
            spawn_system = {
                min_distance = 10
                max_distance = 12
                initializer = antimatter_legion_Sub_galaxies
                effect = {
                    set_name = "NAME_ZHIZUO"
                    save_global_event_target_as = antimatter_legion_Sub_galaxies5
                    random_system_planet = {
                        limit = {
                            has_planet_flag = born_antimatter_legion
                        }
                        planet_event = { id = DDT_FY.25 days = 50 }
                    }
                }
            }
            set_spawn_system_batch = end
            add_hyperlane = {
                from = event_target:antimatter_legion_Sub_galaxies5
                to = This
            }
        }
    }
}
country_event = {
    id = DDT_FY.17
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_system = {
            limit = {
                count_system_planet = {
                    limit = {
                        is_star = yes
                    }
                    count >= 2
                }
            }
            set_star_flag = sixth_star_order
            set_spawn_system_batch = begin
            spawn_system = {
                min_distance = 10
                max_distance = 12
                initializer = antimatter_legion_Sub_galaxies
                effect = {
                    set_name = "NAME_TUNXING"
                    save_global_event_target_as = antimatter_legion_Sub_galaxies6
                    random_system_planet = {
                        limit = {
                            has_planet_flag = born_antimatter_legion
                        }
                        planet_event = { id = DDT_FY.26 days = 60 }
                    }
                }
            }
            set_spawn_system_batch = end
            add_hyperlane = {
                from = event_target:antimatter_legion_Sub_galaxies6
                to = This
            }
        }
    }
}
country_event = {
    id = DDT_FY.18
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        random_system = {
            limit = {
                star = {
                    is_star_class = sc_black_hole
                }
            }
            set_star_flag = seventh_star_order
            set_spawn_system_batch = begin
            spawn_system = {
                min_distance = 10
                max_distance = 12
                initializer = antimatter_legion_Sub_galaxies
                effect = {
                    set_name = "NAME_CHONGXIAN"
                    save_global_event_target_as = antimatter_legion_Sub_galaxies7
                    random_system_planet = {
                        limit = {
                            has_planet_flag = born_antimatter_legion
                        }
                        planet_event = { id = DDT_FY.27 days = 70 }
                    }
                }
            }
            set_spawn_system_batch = end
            add_hyperlane = {
                from = event_target:antimatter_legion_Sub_galaxies7
                to = This
            }
        }
    }
}
#####diplomatic#####
country_event = {
    id = DDT_FY.12
    diplomatic = yes
    is_triggered_only = yes
    title = DDT_FY.12_name
    desc = DDT_FY.12_desc

    trigger = {
        OR = {
            #From.Prev = {
            #    is_country_type = antimatter_legion
            #}
            From = {
                is_country_type = antimatter_legion
            }
        }
    }

    picture_event_data = {
        room = didui_0_room
        portrait = From.leader
    }

    option = {
        name = DDT_FY.12_name_one
        response_text = DDT_FY.12_desc_one
        is_dialog_only = yes
    }
    option = {
        name = DDT_FY.12_name_two
        response_text = DDT_FY.12_desc_two
        is_dialog_only = yes
    }
    option = {
        name = DDT_FY.12_name_three
    }
    option = {
        name = DDT_FY.12_name_four
    }
}
###first_star_order
planet_event = {
    id = DDT_FY.21
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            owner = {
                begin_event_chain = {
                    event_chain = "antimatter_system_chain"
                    target = this
                }
            }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.1"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet1
        create_species = {
            name = "NAME_antimatter_hm"
            class = "ANTIMATTER"
            namelist = "DOT_SR_HUMAN1"
            #portrait = "hum_robot_red"
            traits = {
                trait = "trait_The_Destruction_special"
            }
            effect = { save_global_event_target_as = ANTIMATTER_pop }
        }
        create_species = {
            name = random
            class = "HUIMIE"
            traits = {
                trait = "trait_The_Destruction_special"
            }
            effect = { save_global_event_target_as = HUIMIE_ruler }
        }
        create_country = {
            name = "NAME_ANTIMATTER"
            species = event_target:ANTIMATTER_pop
            authority = auth_imperial
            ethos = {
                ethic = ethic_gestalt_consciousness
            }
            civics = {
                civic = civic_The_Destruction_TZTG
            }
            type = "antimatter_legion"
            name_list = "DOT_SR_HUMAN1"
            flag = random
            effect = {
                set_graphical_culture = ai_01
                create_leader = {
                    class = admiral
                    species = event_target:HUIMIE_ruler
                    name = random
                    effect = {
                        set_immortal = yes
                        save_event_target_as = antimatter_ruler
                    }
                }
                set_leader = event_target:antimatter_ruler
                create_ship_design = { design = "NAME_AI_Transport" }
                add_ship_design = last_created_design
                create_ship_design = { design = "NAME_AI_Constructor" }
                add_ship_design = last_created_design
                create_ship_design = { design = "NAME_AI_1" }
                add_ship_design = last_created_design
                create_ship_design = { design = "NAME_AI_2" }
                add_ship_design = last_created_design
                create_ship_design = { design = "NAME_antimatter_Starbase" }
                add_ship_design = last_created_design
                save_event_target_as = ANTIMATTER_crisis
            }
        }
        every_owned_pop = { kill_pop = yes }
        reset_planet = yes
        set_name = "NAME_FENFENG"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies1 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        every_country = {
            limit = {
                OR = {
                    is_country_type = default
                    is_country_type = fallen_empire
                    is_country_type = awakened_fallen_empire
                }
            }
            establish_communications_no_message = event_target:ANTIMATTER_crisis
        }
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.201 } }

        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        create_point_of_interest = {
            id = an_crisis.1
            name = "NAME_FENFENG"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
###second_star_order
planet_event = {
    id = DDT_FY.22
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.2"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet2
        random_country = {
            limit = { is_country_type = antimatter_legion }
            save_event_target_as = ANTIMATTER_crisis
        }
        reset_planet = yes
        set_name = "NAME_XINGXIAO"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies2 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.202 } }
        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        create_point_of_interest = {
            id = an_crisis.2
            name = "NAME_XINGXIAO"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
###third_star_order
planet_event = {
    id = DDT_FY.23
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.3"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet3
        random_country = {
            limit = { is_country_type = antimatter_legion }
            save_event_target_as = ANTIMATTER_crisis
        }
        reset_planet = yes
        set_name = "NAME_TIEMU"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies3 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.203 } }
        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        create_point_of_interest = {
            id = an_crisis.3
            name = "NAME_TIEMU"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
###fourth_star_order
planet_event = {
    id = DDT_FY.24
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.4"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet4
        random_country = {
            limit = { is_country_type = antimatter_legion }
            save_event_target_as = ANTIMATTER_crisis
        }
        reset_planet = yes
        set_name = "NAME_DUSHEN"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies4 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.204 } }
        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        create_point_of_interest = {
            id = an_crisis.4
            name = "NAME_DUSHEN"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
###fifth_star_order
planet_event = {
    id = DDT_FY.25
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.5"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet5
        random_country = {
            limit = { is_country_type = antimatter_legion }
            save_event_target_as = ANTIMATTER_crisis
        }
        reset_planet = yes
        set_name = "NAME_ZHIZUO"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies5 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.205 } }
        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        create_point_of_interest = {
            id = an_crisis.5
            name = "NAME_ZHIZUO"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
###sixth_star_order
planet_event = {
    id = DDT_FY.26
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.6"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet6
        random_country = {
            limit = { is_country_type = antimatter_legion }
            save_event_target_as = ANTIMATTER_crisis
        }
        reset_planet = yes
        set_name = "NAME_TUNXING"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies6 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.206 } }
        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes

        }
        create_point_of_interest = {
            id = an_crisis.6
            name = "NAME_TUNXING"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
###seventh_star_order
planet_event = {
    id = DDT_FY.27
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no }
            enable_special_project = {
                name = "FIND_HOME_SYSTEM.7"
                location = root.solar_system
                owner = this.capital_scope
            }
        }
        set_planet_flag = an_planet7
        random_country = {
            limit = { is_country_type = antimatter_legion }
            save_event_target_as = ANTIMATTER_crisis
            country_event = { id = DDT_FY.5 }
        }
        reset_planet = yes
        set_name = "NAME_CHONGXIAN"
        set_owner = event_target:ANTIMATTER_crisis
        set_controller = event_target:ANTIMATTER_crisis
        event_target:antimatter_legion_Sub_galaxies7 = {
            every_system_planet = {
                create_antimatter_starbase_defense = yes
            }
        }
        create_antimatter_planet_defense = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet = yes
        create_antimatter_fleet_defence = yes
        planet_event = { id = DDT_FY.3000 } # Start Fleet reinforcement cycle
        planet_event = { id = DDT_FY.3001 } # Start Army reinforcement cycle
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_or"
                amount = 1
            }
        }
        every_country = { country_event = { id = DDT_FY.207 } }
        solar_system = {
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        create_point_of_interest = {
            id = an_crisis.7
            name = "NAME_CHONGXIAN"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
####### Final System ########
country_event = {
    id = DDT_FY.131
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.1
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
country_event = {
    id = DDT_FY.132
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.2
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
country_event = {
    id = DDT_FY.133
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.3
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
country_event = {
    id = DDT_FY.134
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.4
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
country_event = {
    id = DDT_FY.135
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.5
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
country_event = {
    id = DDT_FY.136
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.6
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
country_event = {
    id = DDT_FY.137
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        set_global_flag = find_an_system.7
        country_event = { id = DDT_FY.138 days = 1 }
    }
}
#判断特殊项目是否完成
country_event = {
    id = DDT_FY.138
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        has_global_flag = find_an_system.1
        has_global_flag = find_an_system.2
        has_global_flag = find_an_system.3
        has_global_flag = find_an_system.4
        has_global_flag = find_an_system.5
        has_global_flag = find_an_system.6
        has_global_flag = find_an_system.7
    }

    immediate = {
        random_rim_system = {
            random_system_planet = {
                planet_event = { id = DDT_FY.32 days = 10 }
            }
        }
        every_country = {
            limit = {
                is_ai = no
                is_antimatter_must = yes
            }
            set_country_flag = allow_stage_special
        }
    }
}
#添加最后的星系
planet_event = {
    id = DDT_FY.32
    is_triggered_only = yes
    hide_window = yes

    trigger = {
    }

    immediate = {
        random_rim_system = {
            spawn_system = {
                min_distance >= 20
                max_distance <= 50
                initializer = "antimatter_legion_home_system"
                effect = {
                    save_global_event_target_as = antimatter_legion_home_system
                }
            }
        }
        event_target:antimatter_legion_home_system = {
            #limit = {
            #    has_star_flag = antimatter_legion_home_system
            #}
            #移除可能的问题，一般也用不上
            every_country = {
                limit = { is_ai = no }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.7
                }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.6
                }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.5
                }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.4
                }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.3
                }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.2
                }
                abort_special_project = {
                    type = FIND_HOME_SYSTEM.1
                }
            }
            #添加特殊项目
            random_system_planet = {
                limit = {
                    has_planet_flag = antimatter_legion_home_planet
                }
                every_country = {
                    limit = {
                        is_ai = no
                        is_antimatter_must = yes
                    }
                    enable_special_project = {
                        name = "FIND_HOME_SYSTEM.8"
                        location = Prev.solar_system
                        owner = this.capital_scope
                    }
                }
                while = {
                    count = 10
                    owner = {
                        create_leader = {
                            class = admiral
                            species = event_target:ANTIMATTER_pop
                            name = random
                            skill = 3
                            effect = {
                                set_age = 0
                                save_event_target_as = ANTIMATTER_fleet_leader
                            }
                        }
                    }
                    create_fleet = {
                        effect = {
                            set_owner = event_target:ANTIMATTER_crisis
                            while = {
                                count = 10
                                create_ship = {
                                    name = random
                                    design = "NAME_Euthanizer"
                                    graphical_culture = "ai_01"
                                }
                            }
                            assign_leader = event_target:ANTIMATTER_fleet_leader
                            while = {
                                count = 20
                                create_ship = {
                                    name = random
                                    design = "NAME_Sterilizer"
                                    graphical_culture = "ai_01"
                                }
                            }
                            set_location = {
                                target = Prev
                                distance = 45
                                angle = random
                            }
                            set_fleet_bombardment_stance = indiscriminate
                            set_fleet_flag = XT_Crisis_1_fleet
                            fleet_event = { id = DDT_FY.4000 }
                            event_target:ANTIMATTER_crisis = {
                                change_variable = { which = "xfleet_id" value = 1 }
                            }
                            set_variable = { which = "xfleet_id" value = event_target:ANTIMATTER_crisis.xfleet_id }
                            solar_system = { set_variable = { which = XT_Crisis_1_fleet_id value = prev.xfleet_id } }
                            create_antimatter_starbase_buff = yes
                        }
                    }
                }
                while = {
                    count = 5
                    owner = {
                        create_leader = {
                            class = admiral
                            species = event_target:ANTIMATTER_pop
                            name = random
                            skill = 3
                            effect = {
                                set_age = 0
                                save_event_target_as = ANTIMATTER_fleet_leader
                            }
                        }
                    }
                    create_fleet = {
                        effect = {
                            set_owner = event_target:ANTIMATTER_crisis
                            while = {
                                count = 10
                                create_ship = {
                                    name = random
                                    design = "NAME_Euthanizer"
                                    graphical_culture = "ai_01"
                                }
                            }
                            assign_leader = event_target:ANTIMATTER_fleet_leader
                            while = {
                                count = 20
                                create_ship = {
                                    name = random
                                    design = "NAME_Sterilizer"
                                    graphical_culture = "ai_01"
                                }
                            }
                            set_location = {
                                target = Prev
                                distance = 45
                                angle = random
                            }
                            create_antimatter_starbase_buff = yes
                        }
                    }
                }
            }
            #刷防御平台
            random_system_planet = {
                create_antimatter_starbase_defense = yes
            }
            if = {
                limit = { exists = starbase }
                starbase = {
                    fleet = {
                        destroy_fleet = this
                    }
                }
            }
            create_antimatter_starbase = yes
        }
        observer_event = { id = DDT_FY.6 }
        every_country = {
            limit = { is_ai = no
                is_antimatter_must = yes }
            country_event = { id = DDT_FY.7 }
            country_event = { id = DDT_FY.8 days = 5 }
            end_event_chain = antimatter_system_chain
        }
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
        }
        create_point_of_interest = {
            id = an_crisis_home1
            name = "NAME_YDLF"
            event_chain = "antimatter_legion_chain"
            location = from
        }
    }
}
#特殊项目完成，毁灭天灾主线就此结束
country_event = {
    id = DDT_FY.43
    title = DDT_FY.43_name
    desc = DDT_FY.43_desc
    is_triggered_only = yes
    picture = GFX_evt_exploding_planet

    immediate = {
        every_country = {
            abort_special_project = {
                type = FIND_HOME_SYSTEM.8
            }
        }
    }

    option = {
        name = DDT_FY.43_name_one
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
            country_event = { id = DDT_FY.50 days = 100 }
        }
    }
    option = {
        name = DDT_FY.43_name_two
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            end_event_chain = antimatter_legion_chain
        }
    }
}
#####彩蛋
country_event = {
    id = DDT_FY.50
    title = DDT_FY.50_name
    desc = DDT_FY.50_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3

    option = {
        name = DDT_FY.50_name_one
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            end_event_chain = antimatter_legion_chain
        }
    }
    option = {
        name = DDT_FY.50_name_two
        every_country = {
            limit = {
                has_event_chain = "antimatter_legion_chain"
                is_ai = no
            }
            add_event_chain_counter = {
                event_chain = "antimatter_legion_chain"
                counter = "antimatter_jz"
                amount = 1
            }
            country_event = { id = DDT_FY.51  days = 100}
        }
    }
}
country_event = {
    id = DDT_FY.51
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        no_scope = {
            spawn_system = {
                min_distance = 50
                max_distance = 200
                initializer = home_system_huimie_star
                effect = {
                    save_global_event_target_as = home_system_huimie_star
                }
            }
        }
        event_target:home_system_huimie_star = {
            random_system_planet = {
                limit = {
                    has_planet_flag = home_system_huimie_star_planet
                }
                planet_event = { id = DDT_FY.52 }
            }
        }
    }
}
planet_event = {
    id = DDT_FY.52
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = { is_ai = no
                is_antimatter_must = yes}
            enable_special_project = {
                name = "FIND_HOME_SYSTEM_HUIMIE"
                location = root
                owner = this.capital_scope
            }
        }
        random_system = {
            limit = {
                has_star_flag = home_system_huimie_star_star
            }
            random_system_planet = {
                limit = {
                    has_planet_flag = home_system_huimie_star_planet
                }
                #enable_special_project = {
                #    name = "FIND_HOME_SYSTEM_HUIMIE"
                #    location = This
                #    owner = Root.owner
                #}
                create_point_of_interest = {
                    id = an_crisis_home_home1
                    name = "NAME_YDLF"
                    event_chain = "antimatter_legion_chain"
                    location = from
                }
            }
        }
    }
}
country_event = {
    id = DDT_FY.53
    title = DDT_FY.53_name
    desc = DDT_FY.53_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3

    option = {
        name = OK
        every_country = {
            limit = { has_event_chain = "antimatter_legion_chain" }
            end_event_chain = antimatter_legion_chain
            abort_special_project = {
                type = FIND_HOME_SYSTEM_HUIMIE
            }
        }
    }
}
###################### 提 示 事 件 ######################
country_event = {
    id = DDT_FY.201
    title = DDT_FY.201_name
    desc = DDT_FY.201_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1

    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.202
    title = DDT_FY.202_name
    desc = DDT_FY.202_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.203
    title = DDT_FY.203_name
    desc = DDT_FY.203_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.204
    title = DDT_FY.204_name
    desc = DDT_FY.204_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.205
    title = DDT_FY.205_name
    desc = DDT_FY.205_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.206
    title = DDT_FY.206_name
    desc = DDT_FY.206_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.207
    title = DDT_FY.207_name
    desc = DDT_FY.207_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_1
    option = {
        name = OK
    }
}
#七个特殊项目完成提示加移除不必要的flag
country_event = {
    id = DDT_FY.211
    title = DDT_FY.211_name
    desc = DDT_FY.211_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3

    immediate = {
            every_country = {
                limit = {
                    is_country_type = antimatter_legion
                }
                every_owned_planet = {
                    limit = {
                        has_planet_flag = an_planet1
                    }
                    remove_planet_flag = an_planet1
                }
            }
    }
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.212
    title = DDT_FY.212_name
    desc = DDT_FY.212_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3
    immediate = {
        every_country = {
            limit = {
                is_country_type = antimatter_legion
            }
            every_owned_planet = {
                limit = {
                    has_planet_flag = an_planet2
                }
                remove_planet_flag = an_planet2
            }
        }
    }
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.213
    title = DDT_FY.213_name
    desc = DDT_FY.213_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3
    immediate = {
        every_country = {
            limit = {
                is_country_type = antimatter_legion
            }
            every_owned_planet = {
                limit = {
                    has_planet_flag = an_planet3
                }
                remove_planet_flag = an_planet3
            }
        }
    }
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.214
    title = DDT_FY.214_name
    desc = DDT_FY.214_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3
    immediate = {
        every_country = {
            limit = {
                is_country_type = antimatter_legion
            }
            every_owned_planet = {
                limit = {
                    has_planet_flag = an_planet4
                }
                remove_planet_flag = an_planet4
            }
        }
    }
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.215
    title = DDT_FY.215_name
    desc = DDT_FY.215_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3
    immediate = {
        every_country = {
            limit = {
                is_country_type = antimatter_legion
            }
            every_owned_planet = {
                limit = {
                    has_planet_flag = an_planet5
                }
                remove_planet_flag = an_planet5
            }
        }
    }
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.216
    title = DDT_FY.216_name
    desc = DDT_FY.216_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3
    immediate = {
        every_country = {
            limit = {
                is_country_type = antimatter_legion
            }
            every_owned_planet = {
                limit = {
                    has_planet_flag = an_planet6
                }
                remove_planet_flag = an_planet6
            }
        }
    }
    option = {
        name = OK
    }
}
country_event = {
    id = DDT_FY.217
    title = DDT_FY.217_name
    desc = DDT_FY.217_desc
    is_triggered_only = yes
    picture = GFX_evt_crisis_3
    immediate = {
        every_country = {
            limit = {
                is_country_type = antimatter_legion
            }
            every_owned_planet = {
                limit = {
                    has_planet_flag = an_planet7
                }
                remove_planet_flag = an_planet7
            }
        }
    }
    option = {
        name = OK
    }
}
######################  U I 事 件 (建议不要动)   ######################
country_event = {
    id = DDT_FY.1999
    is_triggered_only = yes
    hide_window = yes

    trigger = {
        is_antimatter_must = yes
        is_ai =  no
    }

    immediate = {
            set_country_flag = allow_stage1_xt
        set_country_flag = allow_set_xt_crisis_global
    }
}
country_event = {
    id = DDT_FY.2000
    is_triggered_only = yes
    diplomatic = yes
    custom_gui = xt_crisis_set

    trigger = {
        is_antimatter_must = yes
    }

    immediate = {
        set_country_flag = allow_add_xtui
        set_country_flag = allow_sub_xtui
        set_country_flag = allow_set_xt_crisis_global
        if = {
            limit = {
                NOT = {
                    OR = {
                        has_country_flag = allow_stage2_xt
                        has_country_flag = allow_stage3_xt
                        has_country_flag = allow_stage4_xt
                    }
                }
            }
            set_country_flag = allow_stage1_xt
        }
    }
}
######################  舰 队 事 件 (建议不要动)  ######################
planet_event = {
    id = DDT_FY.3000
    hide_window = yes

    is_triggered_only = yes

    trigger = {
        owner = { is_country_type = "antimatter_legion" }
    }

    immediate = {
        if = {
            limit = {
                has_global_flag = find_an_system.1
                has_global_flag = find_an_system.2
                has_global_flag = find_an_system.3
                has_global_flag = find_an_system.4
                has_global_flag = find_an_system.5
                has_global_flag = find_an_system.6
                has_global_flag = find_an_system.7
            }
        }
        else_if = {
            limit = {
                owner = { num_ships > 8000 }
            }
            planet_event = { id = DDT_FY.3000 days = 600 }
        }
        else = {
            #limit = { trigger_planet_add_fleet = yes }
            planet_event = { id = DDT_FY.3000 days = 600 random = 200 }
            create_antimatter_fleet = yes
        }
    }
}
planet_event = {
    id = DDT_FY.3001
    hide_window = yes

    is_triggered_only = yes

    trigger = {
        owner = { is_country_type = "antimatter_legion" }
    }

    immediate = {
        if = {
            limit = {
                has_global_flag = find_an_system.1
                has_global_flag = find_an_system.2
                has_global_flag = find_an_system.3
                has_global_flag = find_an_system.4
                has_global_flag = find_an_system.5
                has_global_flag = find_an_system.6
                has_global_flag = find_an_system.7
            }
        }
        else = {
            planet_event = { id = DDT_FY.3001 days = 600 random = 200 }
            create_antimatter_fleet = yes
        }
    }
}
#舰队行为主触发#   ##该模板取自地砖大佬公用素材##
fleet_event = {
    id = DDT_FY.4000
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        exists = this
        has_fleet_flag = XT_Crisis_1_fleet
        owner = { is_country_type = antimatter_legion }
    }
    immediate = {
        queue_actions = {
            repeat = {
                effect = {
                    id = SRA_RE_Crisis.39.e0
                    if = {
                        limit = { count_system = {
                            limit = { check_variable = { which = XT_Crisis_1_fleet_id value > 0 } }
                            count = all
                        } }
                        every_system = {
                            set_variable = { which = XT_Crisis_1_fleet_id value = 0 }
                            clear_variable = XT_Crisis_1_fleet_id
                        }
                    }
                    if = {
                        limit = { has_fleet_flag = XT_Crisis_cannot_find_path }
                        random_system = {
                            limit = {
                                OR = {
                                    AND = {
                                        exists = starbase
                                    }
                                    any_system_planet = { OR = { is_colony = yes is_colonizable = yes } }
                                }
                            }
                            random_system_planet = { ROOT = { set_location = { target = PREV distance = 5 angle = random } } }
                        }
                        remove_fleet_flag = XT_Crisis_cannot_find_path
                    }
                }
                find_closest_system = {
                    trigger = {
                        id = SRA_RE_Crisis.39.t1
                        OR = {
                            AND = {
                                exists = starbase
                            }
                            any_system_planet = { OR = { is_colony = yes is_colonizable = yes } }
                        }
                        ROOT = { can_access_system = prev }
                        check_variable = { which = XT_Crisis_1_fleet_id value < 1 }
                    }
                    found_system = {
                        effect = {
                            id = SRA_RE_Crisis.39.e1
                            set_variable = { which = XT_Crisis_1_fleet_id value = root.xfleet_id }
                        }
                        move_to = this
                        repeat = {
                            while = {
                                id = SRA_RE_Crisis.39.t2
                                any_system_planet = { OR = { is_colony = yes is_colonizable = yes } }
                            }
                            find_closest_planet = {
                                trigger = {
                                    id = SRA_RE_Crisis.39.t3
                                    OR = { is_colony = yes is_colonizable = yes }
                                }
                                found_planet = {
                                    orbit_planet = this
                                    effect = {
                                        id = SRA_RE_Crisis.39.e2
                                        ROOT = { set_fleet_flag = XT_Crisis_bombarding_planet }
                                        if = {
                                            #未殖民宜居星球过3个月炸掉
                                            limit = { is_colony = no is_colonizable = yes }
                                            set_planet_flag = XT_Crisis_target_planet
                                            planet_event = { id = DDT_FY.4001 days = 90 }
                                        }
                                        if = {
                                            #已殖民宜居星球过3个月炸掉
                                            limit = { is_colony = yes is_colonizable = yes }
                                            set_planet_flag = XT_Crisis_target_planet
                                            planet_event = { id = DDT_FY.4001 days = 90 }
                                        }
                                    }
                                    repeat = {
                                        while = {
                                            id = SRA_RE_Crisis.39.t4
                                            ROOT = { has_fleet_flag = XT_Crisis_bombarding_planet }
                                        }
                                        effect = {
                                            id = SRA_RE_Crisis.39.e3
                                            if = {
                                                limit = { is_colony = no is_colonizable = no }
                                                ROOT = { remove_fleet_flag = XT_Crisis_bombarding_planet }
                                            }
                                        }
                                        wait = { duration = 5 random = 10 }
                                    }
                                }
                            }
                            move_to = this							# move away from the planet
                            wait = { duration = 5 random = 10 }
                        }
                        wait = { duration = 5 random = 10 }
                    }
                    failed = { find_closest_system = {
                        trigger = {
                            id = SRA_RE_Crisis.39.t9
                            ROOT = { can_access_system = prev }
                            check_variable = { which = XT_Crisis_1_fleet_id value < 1 }
                        }
                        found_system = {
                            effect = {
                                id = SRA_RE_Crisis.39.t91
                                set_variable = { which = XT_Crisis_1_fleet_id value = root.xfleet_id }
                            }
                            move_to = this
                            repeat = {
                                while = {
                                    id = SRA_RE_Crisis.39.t10
                                    any_system_planet = { OR = { is_colony = yes is_colonizable = yes } }
                                }
                                find_closest_planet = {
                                    trigger = {
                                        id = SRA_RE_Crisis.39.t11
                                        OR = { is_colony = yes is_colonizable = yes }
                                    }
                                    found_planet = {
                                        orbit_planet = this
                                        effect = {
                                            id = SRA_RE_Crisis.39.e10
                                            ROOT = { set_fleet_flag = XT_Crisis_bombarding_planet }
                                            if = {
                                                limit = { is_colony = no is_colonizable = yes }
                                                set_planet_flag = XT_Crisis_target_planet
                                                planet_event = { id = DDT_FY.4001 days = 30 }
                                            }
                                        }
                                        repeat = {
                                            while = {
                                                id = SRA_RE_Crisis.39.t12
                                                ROOT = { has_fleet_flag = XT_Crisis_bombarding_planet }
                                            }
                                            effect = {
                                                id = SRA_RE_Crisis.39.e11
                                                if = {
                                                    limit = { is_colony = no is_colonizable = no }
                                                    ROOT = { remove_fleet_flag = XT_Crisis_bombarding_planet }
                                                }
                                            }
                                            wait = { duration = 5 random = 10 }
                                        }
                                    }
                                }
                                move_to = this											# move away from the planet
                                wait = { duration = 5 random = 10 }
                            }
                            wait = { duration = 5 random = 10 }
                        }
                        failed = { effect = { id = SRA_RE_Crisis.39.e13 ROOT = { set_fleet_flag = XT_Crisis_cannot_find_path } } wait = 200 }
                    }
                    }
                }
            }
        }
    }
}
planet_event = {
    id = DDT_FY.4001
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        #every_system = {
            #every_system_planet = {
                #limit = {
                    #has_planet_flag = XT_Crisis_target_planet
                #}
                if = {
                    limit = {
                        is_planet_class = pc_habitat_honkai
                        is_planet_class = pc_habitat_shielded
                        is_planet_class = pc_habitat
                        is_planet_class = pc_ringworld_habitable
                    }
                    remove_planet = yes
                    destroy_colony = yes
                }
                else = {
                    change_pc = pc_broken
                }
            }
       # }
   # }
}
######################    测 试 ------ 挂 来    ######################
country_event = {
    id = DDT_FY.6666
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            limit = {
                is_ai = no
            }
            add_modifier = {
                modifier = gua
            }
            add_resource = {
                energy = 999999999
                minerals = 999999999
                consumer_goods = 999999999
                food = 999999999
                alloys = 999999999
            }
            while = {
                count = 10
                owner = {
                    create_leader = {
                        class = admiral
                        species = owner_main_species
                        name = random
                        skill = 3
                        effect = {
                            set_age = 0
                            save_event_target_as = waigua_leader
                        }
                    }
                }
                create_fleet = {
                    effect = {
                        set_owner = Prev
                        while = {
                            count = 10
                            create_ship = {
                                name = random
                                design = "NAME_Euthanizer"
                                graphical_culture = "ai_01"
                            }
                        }
                        assign_leader = event_target:waigua_leader
                        while = {
                            count = 20
                            create_ship = {
                                name = random
                                design = "NAME_Sterilizer"
                                graphical_culture = "ai_01"
                            }
                        }
                        set_location = {
                            target = Prev.capital_scope
                            distance = 45
                            angle = random
                        }
                        add_modifier = {
                            modifier = guapluse
                        }
                    }
                }
            }
        }
    }
}